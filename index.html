<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Love Quest</title>
  <style>
    :root {
      --plum: #2a1030;
      --pink: #ff3fa7;
      --cream: #fff1d0;
      --black: #0b0a0d;
      --deep: #16081b;
      --success: #7fffd4;
      --danger: #ff6b6b;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Courier New", monospace;
      background: radial-gradient(circle at top, #3b1445, var(--deep) 60%);
      color: var(--cream);
      min-height: 100vh;
      overflow-x: hidden;
    }

    .scanlines::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0.03),
        rgba(255, 255, 255, 0.03) 2px,
        transparent 2px,
        transparent 4px
      );
      z-index: 999;
    }

    .hud {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      background: #000;
      color: var(--cream);
      padding: 10px 16px;
      border-bottom: 4px solid var(--pink);
      display: flex;
      justify-content: space-between;
      align-items: center;
      letter-spacing: 1px;
      text-transform: uppercase;
      font-weight: 700;
      box-shadow: 0 4px 0 #fff;
    }

    .hud span { font-size: clamp(12px, 2vw, 16px); }

    .game-wrap {
      position: relative;
      padding: 92px 16px 32px;
      max-width: 980px;
      margin: 0 auto;
      min-height: 100vh;
      z-index: 2;
    }

    .panel {
      background: rgba(11, 10, 13, 0.85);
      border: 4px solid var(--cream);
      box-shadow: 0 0 0 4px var(--black), 0 0 0 8px var(--pink);
      padding: 18px;
      margin: 20px auto;
      max-width: 900px;
    }

    h1, h2, h3 {
      margin-top: 0;
      line-height: 1.2;
      text-transform: uppercase;
      text-shadow: 2px 2px 0 var(--black);
    }

    h1 { color: var(--pink); font-size: clamp(24px, 4vw, 42px); }
    h2 { color: var(--pink); font-size: clamp(20px, 3vw, 30px); }

    p { line-height: 1.45; font-size: 16px; }

    .rules {
      border: 3px dashed var(--pink);
      padding: 14px;
      margin: 16px 0;
      background: rgba(255, 63, 167, 0.09);
    }

    .btn, button {
      background: var(--pink);
      color: var(--cream);
      border: 0;
      padding: 10px 16px;
      font-family: inherit;
      font-weight: 700;
      text-transform: uppercase;
      cursor: pointer;
      margin-top: 10px;
      box-shadow: 0 4px 0 #7f1f56, 4px 4px 0 #000;
      transition: transform 0.08s;
    }

    .btn:active, button:active { transform: translateY(2px); box-shadow: 0 2px 0 #7f1f56, 2px 2px 0 #000; }

    .options {
      display: grid;
      gap: 10px;
      margin-top: 14px;
    }

    .option {
      display: block;
      width: 100%;
      text-align: left;
      background: #3f1444;
      border: 2px solid var(--cream);
      color: var(--cream);
      padding: 12px;
      font-size: 15px;
      box-shadow: 3px 3px 0 #000;
    }

    .option:hover { border-color: var(--pink); }

    input[type="text"] {
      width: min(420px, 100%);
      background: #140a1a;
      color: var(--cream);
      border: 3px solid var(--cream);
      padding: 10px;
      font-family: inherit;
      font-size: 16px;
      box-shadow: 3px 3px 0 #000;
      text-transform: lowercase;
    }

    .shake {
      animation: shake 0.34s linear;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-6px); }
      50% { transform: translateX(6px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }

    .achievement-overlay {
      position: fixed;
      inset: 0;
      z-index: 250;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.7);
      padding: 18px;
    }

    .achievement-card {
      max-width: 640px;
      width: 100%;
      background: #18081f;
      border: 4px solid var(--success);
      box-shadow: 0 0 0 4px #000, 0 0 0 8px var(--pink);
      padding: 20px;
      text-align: center;
    }

    .achievement-card h3 { color: var(--success); margin-bottom: 8px; }

    .reward-card {
      max-width: 520px;
      width: 100%;
      background: #1a0b21;
      border: 4px solid var(--cream);
      box-shadow: 0 0 0 4px #000, 0 0 0 8px var(--pink);
      padding: 20px;
      text-align: center;
    }

    .mushroom-icon {
      width: 120px;
      height: 120px;
      margin: 0 auto 12px;
      image-rendering: pixelated;
      filter: drop-shadow(3px 3px 0 #000);
    }

    .hidden { display: none !important; }

    .status {
      min-height: 24px;
      font-weight: 700;
      margin-top: 10px;
    }

    .good { color: var(--success); }
    .bad { color: var(--danger); }

    .floaters {
      position: fixed;
      inset: 0;
      z-index: 0;
      overflow: hidden;
      pointer-events: none;
    }

    .floater {
      position: absolute;
      font-size: 20px;
      opacity: 0.18;
      animation: drift linear infinite;
    }

    @keyframes drift {
      from { transform: translateY(110vh); }
      to { transform: translateY(-20vh); }
    }

    .witch-wrap {
      position: fixed;
      right: 14px;
      bottom: 10px;
      z-index: 180;
      width: 170px;
      pointer-events: none;
    }

    .witch {
      width: 90px;
      height: 90px;
      margin-left: auto;
      display: block;
      image-rendering: pixelated;
      shape-rendering: crispEdges;
      filter: drop-shadow(0 0 0 var(--cream)) drop-shadow(3px 3px 0 #000);
    }

    .bubble {
      max-width: 260px;
      margin-left: auto;
      margin-bottom: 10px;
      background: var(--cream);
      color: #1a0c1e;
      padding: 10px;
      border: 3px solid #000;
      box-shadow: 4px 4px 0 var(--pink);
      opacity: 0;
      transform: translateY(8px);
      transition: all 240ms ease;
      font-size: 13px;
      font-weight: 700;
    }

    .bubble.show {
      opacity: 1;
      transform: translateY(0);
    }

    .error-bubble {
      position: fixed;
      right: 14px;
      bottom: 14px;
      z-index: 190;
      margin: 0;
      max-width: min(320px, calc(100vw - 28px));
      pointer-events: none;
    }

    .level-meta {
      margin: 0 0 8px;
      color: #ffb9de;
      font-size: 14px;
    }

    .letter {
      margin-top: 12px;
      border: 2px solid var(--pink);
      padding: 12px;
      background: rgba(255, 241, 208, 0.08);
    }

    @media (max-width: 760px) {
      .witch-wrap { width: 140px; right: 8px; }
      .bubble { font-size: 12px; }
      .game-wrap { padding-top: 86px; }
    }
  </style>
</head>
<body class="scanlines">
  <div class="hud">
    <span id="hudLevel">LEVEL 0/6</span>
    <span id="hudMushrooms">üçÑ x0</span>
    <span id="hudMistakes">WITCH x0</span>
  </div>

  <div class="floaters" id="floaters"></div>

  <main class="game-wrap">
    <section id="screen" class="panel"></section>
  </main>

  <div id="errorBubble" class="bubble error-bubble" aria-live="polite"></div>

  <div id="achievementOverlay" class="achievement-overlay hidden">
    <div class="achievement-card">
      <h3 id="achievementTitle"></h3>
      <p id="achievementText"></p>
      <button id="achievementBtn">Continue</button>
    </div>
  </div>

  <div id="rewardOverlay" class="achievement-overlay hidden">
    <div class="reward-card">
      <svg class="mushroom-icon" viewBox="0 0 16 16" role="img" aria-label="Love Mushroom pixel art">
        <rect width="16" height="16" fill="#000" />
        <rect x="1" y="1" width="14" height="7" fill="#ff3fa7" />
        <rect x="2" y="2" width="2" height="2" fill="#fff1d0" />
        <rect x="6" y="3" width="2" height="2" fill="#fff1d0" />
        <rect x="11" y="2" width="2" height="2" fill="#fff1d0" />
        <rect x="3" y="8" width="10" height="2" fill="#2a1030" />
        <rect x="5" y="10" width="6" height="5" fill="#fff1d0" />
        <rect x="6" y="11" width="1" height="1" fill="#000" />
        <rect x="9" y="11" width="1" height="1" fill="#000" />
      </svg>
      <p>You found a Love Mushroom!</p>
      <button id="rewardClaimBtn">Claim</button>
    </div>
  </div>

  <script>
    // ===== Editable content data =====
    const heroNames = ["Mr. Haban", "Cozy Boy", "Juicy Booty", "Husband", "Captain America"];
    const wifeNames = ["Princess Wife", "Wifey", "Queen of Mushrooms", "Keeper of Cozy"];

    const witchLines = {
      wrong: [
        "The Witch delights in this error. The Hero may attempt redemption.",
        "Incorrect. The Witch records the mistake with glittery ink.",
        "The Princess remains snatched. Focus, Cozy Boy.",
        "The Witch cackles softly. The Storyteller sighs.",
        "A wrong answer. The Witch‚Äôs petty heart grows three sizes."
      ],
      achievement: [
        "Hmph. The Hero remembers. Annoying.",
        "One Love Mushroom restored. The Witch is displeased.",
        "Progress is noted. Grudgingly.",
        "The Witch updates her grudges."
      ],
      random: [
        "The Witch wonders if the Hero is truly a Cozy Boy.",
        "Blankets were invented for a reason.",
        "The scoreboard trembles."
      ]
    };

    const errorBubbleMessages = [
      "You know better, husband",
      "Wrong answer. Try again.",
      "The witch is pleased. Unfortunately.",
      "Nope. You are not a cozy boy",
      "Incorrect. The princess remains snatched."
    ];

    const levels = [
      {
        id: 1,
        prompt: "In the First Chapter, the Princess revealed a peculiar obsession during the corporate feast. What was it?",
        type: "single",
        options: ["Medieval swords", "Baby cows", "Office spreadsheets", "Corporate synergy"],
        correct: "Baby cows",
        achievementTitle: "BOVINE PROPHECY RECALLED",
        achievementText: "The Hero remembers the sacred obsession. The Witch frowns."
      },
      {
        id: 2,
        prompt: "In the grand city of Berlin, the Hero presented sacred offerings to strengthen the legend. Which TWO offerings were they? Two truths are required.",
        type: "multi",
        options: ["A plush cow", "A golden crown", "Four Nothing But Thieves concert tickets", "A medieval sword"],
        correctSet: ["A plush cow", "Four Nothing But Thieves concert tickets"],
        achievementTitle: "OFFERINGS OF BERLIN CONFIRMED",
        achievementText: "Two truths were spoken. The plush prophecy strengthens."
      },
      {
        id: 3,
        prompt: "During the long-distance era, what sustained the couple‚Äôs love across oceans and time zones?",
        type: "single",
        options: ["Frequent flyer miles", "Never stopping Instagram messages", "Dramatic longing", "All of the above"],
        correct: "All of the above",
        achievementTitle: "DISTANCE SPELL RESISTED",
        achievementText: "Miles were defeated. Thumbs proved legendary."
      },
      {
        id: 4,
        prompt: "On what date did the couple hear destiny describe geometry?",
        type: "input",
        accepted: ["august 24", "august 24th", "08/24", "8/24"],
        cutscene: [
          "The chapel glowed with neon.",
          "The officiant proclaimed the ring a circle without beginning or end, as love stretches beyond time itself.",
          "The Hero and the Princess tried not to laugh. They failed."
        ],
        achievementTitle: "THE CIRCLE SERMON SURVIVED",
        achievementText: "Destiny described geometry. Love persisted."
      },
      {
        id: 5,
        prompt: "In the summer of 2024, the Hero escorted the Princess to Nida. The Princess awoke very cold and confused and spoke a short prophecy. What were the words?",
        type: "single",
        options: ["man kar≈°ta", "man nuobodu", "man linksma", "man ≈°alta"],
        correct: "man ≈°alta",
        achievementTitle: "THE NIDA CHILL DECIPHERED",
        achievementText: "The dunes remember. The cold prophecy honored."
      },
      {
        id: 6,
        prompt: "Shrimp tacos from Sunset Cantina. Enchiladas from Celia‚Äôs by the Beach. Cold beer opened. The Pitt glowing on the screen. What phrase erupts when destiny aligns?",
        type: "single",
        options: ["Give me that sweet sweet loving", "Lovely jubbly hubby", "I already watched S02E06", "Hell fucking yeah"],
        correct: "Hell fucking yeah",
        achievementTitle: "COSY FEAST OF DESTINY",
        achievementText: "The sacred phrase rang out across the kingdom."
      }
    ];

    // ===== State =====
    const state = {
      screen: "intro",
      levelIndex: 0,
      mushrooms: 0,
      mistakes: 0,
      unlocked: localStorage.getItem("loveQuestUnlocked") === "true",
      currentHero: "",
      currentWife: "",
      tauntTimer: null,
      letterOpen: false,
      audioCtx: null
    };

    const screenEl = document.getElementById("screen");
    const overlay = document.getElementById("achievementOverlay");
    const achievementTitleEl = document.getElementById("achievementTitle");
    const achievementTextEl = document.getElementById("achievementText");
    const achievementBtn = document.getElementById("achievementBtn");
    const rewardOverlay = document.getElementById("rewardOverlay");
    const rewardClaimBtn = document.getElementById("rewardClaimBtn");
    const bubbleEl = document.getElementById("errorBubble");

    function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

    function rotateNames() {
      state.currentHero = pick(heroNames);
      state.currentWife = pick(wifeNames);
    }

    function updateHUD() {
      const levelLabel = state.screen === "level" ? state.levelIndex + 1 : Math.min(state.levelIndex, 6);
      document.getElementById("hudLevel").textContent = `LEVEL ${levelLabel}/6`;
      document.getElementById("hudMushrooms").textContent = `üçÑ x${state.mushrooms}`;
      document.getElementById("hudMistakes").textContent = `WITCH x${state.mistakes}`;
    }

    function initAudio() {
      if (!state.audioCtx) {
        state.audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
    }

    function tone(freq, duration, type = "square", gain = 0.04, delay = 0) {
      initAudio();
      const ctx = state.audioCtx;
      const osc = ctx.createOscillator();
      const g = ctx.createGain();
      osc.type = type;
      osc.frequency.value = freq;
      g.gain.value = gain;
      osc.connect(g).connect(ctx.destination);
      const start = ctx.currentTime + delay;
      osc.start(start);
      g.gain.exponentialRampToValueAtTime(0.0001, start + duration);
      osc.stop(start + duration);
    }

    function playWrong() {
      tone(120, 0.18, "sawtooth", 0.06);
      tone(90, 0.2, "square", 0.05, 0.05);
    }

    function playCorrect() {
      [440, 554, 659].forEach((f, i) => tone(f, 0.11, "square", 0.05, i * 0.09));
    }

    function playAchievement() {
      [523, 659, 784, 1046].forEach((f, i) => tone(f, 0.12, "triangle", 0.04, i * 0.07));
    }

    function playVictory() {
      [523, 659, 784, 1046, 1318, 1568].forEach((f, i) => tone(f, 0.14, "square", 0.05, i * 0.08));
    }

    function showErrorBubble(messageOptional, ms = 3000) {
      if (!bubbleEl) return;
      const text = messageOptional || pick(errorBubbleMessages);
      bubbleEl.textContent = text;
      bubbleEl.classList.add("show");
      clearTimeout(showErrorBubble._hide);
      showErrorBubble._hide = setTimeout(() => bubbleEl.classList.remove("show"), ms);
    }

    function registerMistake() {
      state.mistakes += 1;
      updateHUD();
      playWrong();
      showErrorBubble();
    }

    function showMushroomReward(onClaimCallback) {
      rewardOverlay.classList.remove("hidden");
      rewardClaimBtn.onclick = () => {
        rewardOverlay.classList.add("hidden");
        state.mushrooms += 1;
        updateHUD();
        playCorrect();
        playAchievement();
        if (typeof onClaimCallback === "function") onClaimCallback();
      };
    }

    function showAchievement(level) {
      achievementTitleEl.textContent = level.achievementTitle;
      achievementTextEl.textContent = level.achievementText;
      overlay.classList.remove("hidden");
      playAchievement();
      updateHUD();
    }

    function continueAfterAchievement() {
      overlay.classList.add("hidden");
      state.levelIndex += 1;
      if (state.levelIndex >= levels.length) {
        state.screen = "final";
        playVictory();
      } else {
        state.screen = "level";
      }
      render();
    }

    function scheduleRandomTaunt() {
      clearTimeout(state.tauntTimer);
      if (state.screen !== "level") return;
      const delay = 18000 + Math.random() * 17000;
      state.tauntTimer = setTimeout(() => {
        if (state.screen === "level") {
          scheduleRandomTaunt();
        }
      }, delay);
    }

    function answerCorrect(level) {
      showMushroomReward(() => {
        showAchievement(level);
      });
    }

    function renderIntro() {
      rotateNames();
      screenEl.innerHTML = `
        <h1>Love Quest: The Snatching of the Queen of Mushrooms</h1>
        <p>Long ago, in a distant land known for its charm and respectable levels of excitement, two strangers met beneath corporate chandeliers. The Hero listened as a bold young woman revealed a peculiar obsession. Laughter followed, and destiny shifted.</p>
        <p>Later, in a grand European capital pulsing with history and rhythm, sacred offerings were exchanged and the legend deepened.</p>
        <p>They crossed oceans. They endured distance. In late summer, beneath neon lights and theatrical vows about eternity and geometry, they bound their fates.</p>
        <p>They built a cozy kingdom near the western sea.</p>
        <p>But on the eve of Valentine‚Äôs Day, as the Queen of Mushrooms journeyed far across continents, the Witch of Long Distance descended.</p>
        <p>With a swirl of pixel smoke, she declared: <em>‚ÄúLet the Hero prove his love‚Ä¶ by recalling the details.‚Äù</em></p>
        <p>${wifeNames.join(", ")}, Scolder of Non-Cozy Boys ‚Äî was snatched away.</p>
        <div class="rules">
          <strong>Rules of the Quest:</strong>
          <p>To rescue Princess Wife, the Hero must collect 6 Love Mushrooms by answering Trials about the couple‚Äôs legend.</p>
          <p>Wrong answers increase Witch Satisfaction.</p>
          <p>The Witch cannot be bribed.</p>
        </div>
        <button id="startBtn">YES, SAVE WIFE</button>
      `;
      document.getElementById("startBtn").onclick = () => {
        state.screen = state.unlocked ? "level" : "password";
        render();
      };
    }

    function renderPassword() {
      rotateNames();
      screenEl.innerHTML = `
        <h2>Trial Zero: Prove the Hero</h2>
        <p class="level-meta">The Storyteller watches as ${state.currentHero} approaches the gate.</p>
        <p>The Storyteller demands the founding city of the legend.</p>
        <input id="passInput" type="text" placeholder="enter password" autocomplete="off" />
        <div><button id="passBtn">Unlock Trial</button></div>
        <div id="passStatus" class="status"></div>
      `;

      const input = document.getElementById("passInput");
      const status = document.getElementById("passStatus");

      function submitPassword() {
        const value = input.value.trim().toLowerCase();
        if (value === "allentown") {
          localStorage.setItem("loveQuestUnlocked", "true");
          state.unlocked = true;
          status.textContent = "ACCESS GRANTED";
          status.className = "status good";
          playCorrect();
          setTimeout(() => {
            state.screen = "level";
            state.levelIndex = 0;
            render();
          }, 550);
        } else {
          registerMistake();
          status.textContent = "ACCESS DENIED";
          status.className = "status bad";
          input.classList.remove("shake");
          void input.offsetWidth;
          input.classList.add("shake");
        }
      }

      document.getElementById("passBtn").onclick = submitPassword;
      input.addEventListener("keydown", (e) => { if (e.key === "Enter") submitPassword(); });
      input.focus();
    }

    function renderSingle(level) {
      const options = level.options.map((opt, i) => `
        <button class="option" data-answer="${opt.replace(/"/g, '&quot;')}">${String.fromCharCode(65 + i)}) ${opt}</button>
      `).join("");
      screenEl.innerHTML = `
        <h2>Trial ${level.id}: The Storyteller Speaks</h2>
        <p class="level-meta">The Storyteller narrows ancient eyes at ${state.currentHero}, while ${state.currentWife} awaits rescue.</p>
        <p>${level.prompt}</p>
        <div class="options">${options}</div>
      `;
      screenEl.querySelectorAll(".option").forEach(btn => {
        btn.onclick = () => {
          const answer = btn.dataset.answer;
          if (answer === level.correct) {
            answerCorrect(level);
          } else {
            registerMistake();
          }
        };
      });
    }

    function renderMulti(level) {
      const rows = level.options.map((opt, i) => `
        <label class="option"><input type="checkbox" value="${opt.replace(/"/g, '&quot;')}" /> ${String.fromCharCode(65 + i)}) ${opt}</label>
      `).join("");
      screenEl.innerHTML = `
        <h2>Trial ${level.id}: Double Truth</h2>
        <p class="level-meta">${state.currentHero} must deliver precision before the Witch writes another smug note.</p>
        <p>${level.prompt}</p>
        <div class="options">${rows}</div>
        <button id="submitMulti">Seal the Offerings</button>
      `;
      document.getElementById("submitMulti").onclick = () => {
        const selected = [...screenEl.querySelectorAll('input[type="checkbox"]:checked')].map(c => c.value);
        const sortedA = [...selected].sort().join("|");
        const sortedB = [...level.correctSet].sort().join("|");
        if (sortedA === sortedB) {
          answerCorrect(level);
        } else {
          registerMistake();
        }
      };
    }

    function renderInput(level) {
      const cutscene = level.cutscene.map(line => `<p>${line}</p>`).join("");
      screenEl.innerHTML = `
        <h2>Trial ${level.id}: Geometry of Destiny</h2>
        <div class="rules">${cutscene}</div>
        <p>${level.prompt}</p>
        <input id="dateInput" type="text" placeholder="type date" autocomplete="off" />
        <div><button id="dateBtn">Offer Date</button></div>
      `;
      const dateInput = document.getElementById("dateInput");
      function submitDate() {
        const value = dateInput.value.trim().toLowerCase();
        if (level.accepted.includes(value)) {
          answerCorrect(level);
        } else {
          registerMistake();
          dateInput.classList.remove("shake");
          void dateInput.offsetWidth;
          dateInput.classList.add("shake");
        }
      }
      document.getElementById("dateBtn").onclick = submitDate;
      dateInput.addEventListener("keydown", (e) => { if (e.key === "Enter") submitDate(); });
      dateInput.focus();
    }

    function rankForMistakes(m) {
      if (m <= 2) return "LOVE LEGEND";
      if (m <= 5) return "CERTIFIED HABAN";
      if (m <= 9) return "CHAOTIC BUT ADORABLE";
      return "WITCH‚ÄôS FAVORITE (STILL LOVED)";
    }

    function renderFinal() {
      screenEl.innerHTML = `
        <h1>YOU WIN ‚ù§Ô∏è</h1>
        <p>The Storyteller declares that Princess Wife has been rescued from the Witch of Long Distance. Cozy blankets shall be restored to the realm.</p>
        <p><strong>Love Mushrooms:</strong> ${state.mushrooms}/6</p>
        <p><strong>Mistakes:</strong> ${state.mistakes}</p>
        <p><strong>Rank:</strong> ${rankForMistakes(state.mistakes)}</p>
        <button id="claimBtn">CLAIM THE PRINCESS</button>
        <div id="letter" class="letter ${state.letterOpen ? "" : "hidden"}">
          <p>The Storyteller reveals a final parchment:</p>
          <p>In San Francisco, the Hero guards the cozy kingdom and rehearses victory dances with only moderate dignity.</p>
          <p>In Vilnius, the Princess Wife reigns across time zones, proving once again that distance is no match for stubborn romance and chaotic humor.</p>
          <p>When February 27 arrives, reunion bells shall ring, snacks shall be over-ordered, and the Witch shall be forced to watch from very far away.</p>
          <p>Love remains undefeated. Even when the Hero is, occasionally, dramatically confused.</p>
        </div>
      `;
      document.getElementById("claimBtn").onclick = () => {
        state.letterOpen = true;
        document.getElementById("letter").classList.remove("hidden");
      };
    }

    function renderLevel() {
      rotateNames();
      const level = levels[state.levelIndex];
      if (!level) {
        state.screen = "final";
        renderFinal();
        return;
      }
      if (level.type === "single") renderSingle(level);
      if (level.type === "multi") renderMulti(level);
      if (level.type === "input") renderInput(level);
    }

    function render() {
      updateHUD();
      scheduleRandomTaunt();
      if (state.screen === "intro") renderIntro();
      else if (state.screen === "password") renderPassword();
      else if (state.screen === "level") renderLevel();
      else if (state.screen === "final") renderFinal();
      else renderIntro();
    }

    achievementBtn.addEventListener("click", continueAfterAchievement);

    // Floating pixel hearts/mushrooms
    (function makeFloaters() {
      const icons = ["üçÑ", "‚ù§", "‚ú¶"];
      const holder = document.getElementById("floaters");
      for (let i = 0; i < 22; i++) {
        const node = document.createElement("span");
        node.className = "floater";
        node.textContent = icons[Math.floor(Math.random() * icons.length)];
        node.style.left = `${Math.random() * 100}%`;
        node.style.animationDuration = `${14 + Math.random() * 22}s`;
        node.style.animationDelay = `${-Math.random() * 26}s`;
        node.style.fontSize = `${14 + Math.random() * 18}px`;
        holder.appendChild(node);
      }
    })();

    // Start game
    render();
  </script>
</body>
</html>
